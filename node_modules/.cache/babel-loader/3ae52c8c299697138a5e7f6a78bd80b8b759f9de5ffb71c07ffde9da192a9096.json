{"ast":null,"code":"// Filter items based on filter state\nexport const filterItems = (items, filters) => {\n  return items.filter(item => {\n    // Search by shk (exact match or partial)\n    if (filters.search && !item.shk.toLowerCase().includes(filters.search.toLowerCase())) {\n      return false;\n    }\n\n    // Filter by name (partial match)\n    if (filters.name && !item.name.toLowerCase().includes(filters.name.toLowerCase())) {\n      return false;\n    }\n\n    // Filter by wr_name (partial match, handle null values)\n    if (filters.wr_name) {\n      if (!item.wr_name || !item.wr_name.toLowerCase().includes(filters.wr_name.toLowerCase())) {\n        return false;\n      }\n    }\n\n    // Filter by condition (exact match)\n    if (filters.condition && item.condition !== filters.condition) {\n      return false;\n    }\n\n    // Filter by ispolnitel (partial match)\n    if (filters.ispolnitel && !item.ispolnitel.toLowerCase().includes(filters.ispolnitel.toLowerCase())) {\n      return false;\n    }\n\n    // Filter by placement status\n    if (filters.placementStatus === 'placed') {\n      // Размещенные: есть значения в wr_shk И wr_name\n      if (!item.wr_shk || !item.wr_name) {\n        return false;\n      }\n    } else if (filters.placementStatus === 'not_placed') {\n      // Неразмещенные: нет значения в wr_shk ИЛИ wr_name\n      if (item.wr_shk && item.wr_name) {\n        return false;\n      }\n    }\n    // Если 'all', то не фильтруем по размещению\n\n    // Filter by date range\n    if (filters.dateFrom || filters.dateTo) {\n      const itemDate = new Date(item.date);\n      if (filters.dateFrom) {\n        const fromDate = new Date(filters.dateFrom);\n        if (itemDate < fromDate) {\n          return false;\n        }\n      }\n      if (filters.dateTo) {\n        const toDate = new Date(filters.dateTo);\n        // Add one day to include the entire end date\n        toDate.setDate(toDate.getDate() + 1);\n        if (itemDate >= toDate) {\n          return false;\n        }\n      }\n    }\n    return true;\n  });\n};\n\n// Get unique values for filter options\nexport const getUniqueConditions = items => {\n  const conditions = items.map(item => item.condition);\n  return Array.from(new Set(conditions)).sort();\n};\n\n// Get unique ispolnitels for filter options\nexport const getUniqueIspolnitels = items => {\n  const ispolnitels = items.map(item => item.ispolnitel);\n  return Array.from(new Set(ispolnitels)).sort();\n};\n\n// Get placement statistics\nexport const getPlacementStats = items => {\n  const placed = items.filter(item => item.wr_shk && item.wr_name).length;\n  const notPlaced = items.length - placed;\n  return {\n    total: items.length,\n    placed,\n    notPlaced\n  };\n};\n\n// Check if any filters are active\nexport const hasActiveFilters = filters => {\n  return !!(filters.search || filters.name || filters.wr_name || filters.condition || filters.ispolnitel || filters.placementStatus !== 'all' || filters.dateFrom || filters.dateTo);\n};\n\n// Reset all filters to empty state\nexport const resetFilters = () => ({\n  search: '',\n  name: '',\n  wr_name: '',\n  condition: '',\n  ispolnitel: '',\n  placementStatus: 'all',\n  dateFrom: '',\n  dateTo: ''\n});","map":{"version":3,"names":["filterItems","items","filters","filter","item","search","shk","toLowerCase","includes","name","wr_name","condition","ispolnitel","placementStatus","wr_shk","dateFrom","dateTo","itemDate","Date","date","fromDate","toDate","setDate","getDate","getUniqueConditions","conditions","map","Array","from","Set","sort","getUniqueIspolnitels","ispolnitels","getPlacementStats","placed","length","notPlaced","total","hasActiveFilters","resetFilters"],"sources":["D:/work/komus/3pl-site/src/features/inventory-table/lib/filterUtils.ts"],"sourcesContent":["import { PlacedItemDto, FilterState } from '../model/types';\n\n// Filter items based on filter state\nexport const filterItems = (items: PlacedItemDto[], filters: FilterState): PlacedItemDto[] => {\n  return items.filter((item) => {\n    // Search by shk (exact match or partial)\n    if (filters.search && !item.shk.toLowerCase().includes(filters.search.toLowerCase())) {\n      return false;\n    }\n\n    // Filter by name (partial match)\n    if (filters.name && !item.name.toLowerCase().includes(filters.name.toLowerCase())) {\n      return false;\n    }\n\n    // Filter by wr_name (partial match, handle null values)\n    if (filters.wr_name) {\n      if (!item.wr_name || !item.wr_name.toLowerCase().includes(filters.wr_name.toLowerCase())) {\n        return false;\n      }\n    }\n\n    // Filter by condition (exact match)\n    if (filters.condition && item.condition !== filters.condition) {\n      return false;\n    }\n\n    // Filter by ispolnitel (partial match)\n    if (filters.ispolnitel && !item.ispolnitel.toLowerCase().includes(filters.ispolnitel.toLowerCase())) {\n      return false;\n    }\n\n    // Filter by placement status\n    if (filters.placementStatus === 'placed') {\n      // Размещенные: есть значения в wr_shk И wr_name\n      if (!item.wr_shk || !item.wr_name) {\n        return false;\n      }\n    } else if (filters.placementStatus === 'not_placed') {\n      // Неразмещенные: нет значения в wr_shk ИЛИ wr_name\n      if (item.wr_shk && item.wr_name) {\n        return false;\n      }\n    }\n    // Если 'all', то не фильтруем по размещению\n\n    // Filter by date range\n    if (filters.dateFrom || filters.dateTo) {\n      const itemDate = new Date(item.date);\n      \n      if (filters.dateFrom) {\n        const fromDate = new Date(filters.dateFrom);\n        if (itemDate < fromDate) {\n          return false;\n        }\n      }\n      \n      if (filters.dateTo) {\n        const toDate = new Date(filters.dateTo);\n        // Add one day to include the entire end date\n        toDate.setDate(toDate.getDate() + 1);\n        if (itemDate >= toDate) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  });\n};\n\n// Get unique values for filter options\nexport const getUniqueConditions = (items: PlacedItemDto[]): string[] => {\n  const conditions = items.map(item => item.condition);\n  return Array.from(new Set(conditions)).sort();\n};\n\n// Get unique ispolnitels for filter options\nexport const getUniqueIspolnitels = (items: PlacedItemDto[]): string[] => {\n  const ispolnitels = items.map(item => item.ispolnitel);\n  return Array.from(new Set(ispolnitels)).sort();\n};\n\n// Get placement statistics\nexport const getPlacementStats = (items: PlacedItemDto[]) => {\n  const placed = items.filter(item => item.wr_shk && item.wr_name).length;\n  const notPlaced = items.length - placed;\n  \n  return {\n    total: items.length,\n    placed,\n    notPlaced,\n  };\n};\n\n// Check if any filters are active\nexport const hasActiveFilters = (filters: FilterState): boolean => {\n  return !!(\n    filters.search || \n    filters.name || \n    filters.wr_name || \n    filters.condition || \n    filters.ispolnitel ||\n    filters.placementStatus !== 'all' ||\n    filters.dateFrom ||\n    filters.dateTo\n  );\n};\n\n// Reset all filters to empty state\nexport const resetFilters = (): FilterState => ({\n  search: '',\n  name: '',\n  wr_name: '',\n  condition: '',\n  ispolnitel: '',\n  placementStatus: 'all',\n  dateFrom: '',\n  dateTo: '',\n}); "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}